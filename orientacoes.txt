ğŸ¯ Desafio AvanÃ§ado: Banco Digital com TransaÃ§Ãµes + EmprÃ©stimos + Investimentos

Agora o banco fictÃ­cio oferece tambÃ©m produtos de investimento, e vocÃª precisa projetar um banco de dados que dÃª suporte a:

movimentaÃ§Ãµes financeiras,

crÃ©dito,

e anÃ¡lises de portfÃ³lio de investimentos.

ğŸ“‚ Estrutura sugerida do banco
1. Clientes

id_cliente (PK)

nome

cpf/cnpj (Ãºnico)

data_nascimento

data_abertura_conta

renda_mensal

cidade / estado / paÃ­s

tipo_conta (corrente, poupanÃ§a, premium)

2. Contas

id_conta (PK)

id_cliente (FK â†’ Clientes)

saldo_atual

limite_credito

3. Transacoes

id_transacao (PK)

id_conta (FK â†’ Contas)

data_transacao

valor (positivo = crÃ©dito, negativo = dÃ©bito)

tipo (compra, depÃ³sito, saque, transferÃªncia, pagamento)

categoria (alimentaÃ§Ã£o, transporte, lazer, salÃ¡rio, etc.)

localizacao

4. Emprestimos

id_emprestimo (PK)

id_cliente (FK â†’ Clientes)

valor_emprestimo

taxa_juros

data_contratacao

data_vencimento

status (ativo, quitado, atrasado)

5. Investimentos

id_investimento (PK)

id_cliente (FK â†’ Clientes)

tipo (renda fixa, fundo, aÃ§Ã£o, ETF, cripto)

ativo (ex.: PETR4, Tesouro Selic, Bitcoin)

data_aplicacao

valor_aplicado

rentabilidade_percentual (simulada, acumulada desde a aplicaÃ§Ã£o)

status (ativo, resgatado)

6. Movimentacoes_Investimentos (para granularidade maior)

id_movimento (PK)

id_investimento (FK â†’ Investimentos)

data_movimento

tipo (compra, venda, aporte, resgate, dividendo, juro)

valor

ğŸ“Œ Tarefas do Desafio
1. Modelagem e volumetria

Insira milhares de clientes, cada um com contas bancÃ¡rias.

Simule dezenas de milhares de transaÃ§Ãµes financeiras.

Cadastre centenas de emprÃ©stimos.

Insira pelo menos 20 mil registros de investimentos (com diferentes ativos e rentabilidades).

Gere movimentaÃ§Ãµes de compra, venda e dividendos para enriquecer a base.

2. Consultas intermediÃ¡rias

Liste o saldo total de cada cliente (contas + investimentos ativos).

Mostre os clientes que tÃªm emprÃ©stimos atrasados e ao mesmo tempo investimentos ativos (dÃ­vida + patrimÃ´nio).

Liste os 5 ativos mais populares entre os clientes.

Mostre a rentabilidade mÃ©dia por tipo de investimento (renda fixa, aÃ§Ãµes, fundos, etc.).

3. Consultas avanÃ§adas (CTE + Window Functions)

Usando ROW_NUMBER, descubra o primeiro investimento de cada cliente.

Usando RANK, liste os clientes com maior patrimÃ´nio em cada cidade.

Usando LAG, calcule a evoluÃ§Ã£o de saldo dos investimentos de cada cliente ao longo do tempo.

Usando NTILE(4), divida os clientes em quartis de acordo com o patrimÃ´nio total (saldo bancÃ¡rio + investimentos).

Usando SUM() OVER(), monte o extrato acumulado de um investimento apÃ³s cada movimentaÃ§Ã£o.

Usando CTE recursivo, simule a evoluÃ§Ã£o de um investimento de renda fixa dia a dia (juros compostos aplicados diariamente).

4. AnÃ¡lises para Machine Learning

Monte features que poderiam ser usadas para modelos de:

Risco de crÃ©dito:

renda vs. saldo mÃ©dio vs. dÃ­vida,

se tem investimentos ativos ou nÃ£o,

% do patrimÃ´nio lÃ­quido comprometido em emprÃ©stimos.

RecomendaÃ§Ã£o de investimentos:

perfil de risco (quanto investe em renda fixa vs. variÃ¡vel),

tempo mÃ©dio de permanÃªncia nos ativos,

diversificaÃ§Ã£o da carteira.

PrevisÃ£o de churn (abandono do banco):

tempo desde o Ãºltimo aporte,

valor mÃ©dio aplicado mensalmente,

concentraÃ§Ã£o em um Ãºnico ativo (risco).

Fraude/atividade suspeita:

movimentaÃ§Ãµes muito rÃ¡pidas de compra/venda,

resgates fora do padrÃ£o,

transaÃ§Ãµes internacionais suspeitas.

5. Extra (nÃ­vel hardcore)

Crie um Ã­ndice em Movimentacoes_Investimentos(data_movimento, id_investimento) para otimizar consultas histÃ³ricas.

Monte uma view materializada simulada com a rentabilidade consolidada dos investimentos mÃªs a mÃªs.

Crie um trigger que impeÃ§a aportes acima de 80% do saldo disponÃ­vel da conta corrente.

ğŸ‘‰ Esse desafio agora cobre todas as frentes de um banco digital moderno:

TransaÃ§Ãµes financeiras,

EmprÃ©stimos,

Investimentos detalhados,

Consultas SQL avanÃ§adas,

Base preparada para Machine Learning.

VocÃª quer que eu monte esse desafio em formato de histÃ³ria narrativa (como se fosse um case da fintech) ou prefere que fique no estilo lista de requisitos tÃ©cnicos que vocÃª segue como guia?